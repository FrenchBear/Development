<HTML>

<HEAD>
<TITLE> How to Obtain &amp; Change the Paper Bins for the Default Printer </TITLE>

<STYLE>
<!--
	BODY  {font-family: "Verdana, Arial, Helvetica"; font-size: 10pt; color: 000000}
	A:link {font-family: "Verdana, Arial, Helvetica"; font-size: 10pt; color: 000000; font-weight: bold}
	A:visited {font-family: "Verdana, Arial, Helvetica"; font-size: 10pt; color: 0099DD; font-weight: bold}
	STRONG {font-family: "Verdana, Arial, Helvetica"; font-size: 14pt; color: 003366; text-decoration: none}
	H1 {font-family: "Verdana, Arial, Helvetica"; font-size: 20pt; color: FF3300; text-decoration: none; margin-left=0}
	H2 {font-family: "Verdana, Arial, Helvetica"; font-size: 14pt; color: 0099FF; text-decoration: none; margin-left=0}
	PRE {font-family: "Courier New, Courier"; font-size: 9pt; color: 000000}
	P {font-family: "Verdana, Arial, Helvetica"; font-size: 10pt; color: 000000} 
	BLOCKQUOTE {font-family: "Verdana, Arial, Helvetica"; font-size: 7pt; color: 000000}
-->
</STYLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<meta name="Author" content="Microsoft Technical Support">
<meta name="KBTitle" content="How to Obtain &amp; Change the Paper Bins for the Default Printer">
<meta name="KBID" content="Q96797 ">
<meta name="KBModify" content="21-JUN-1995">
<meta name="KBCreate" content="28-MAR-1993">
<meta name="KBKeywords" content="kbprint kbprg kbcode">
<meta name="KBArea" content="KB, vbwin">

</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#000000" VLINK="#0099DD" ALINK="#000000" LEFTMARGIN=0 TOPMARGIN=0>
<FONT FACE="Arial" SIZE=2>
<!--TOOLBAR_START-->
<TABLE WIDTH=100% CELLPADDING=0 CELLSPACING=0 BORDER=0>
	<TR>
		<TD WIDTH=500 ROWSPAN=2 VALIGN=TOP>
		<NOBR>
		<FONT FACE="Arial, Helvetica" SIZE=1>
		<A HREF="/" TARGET="_top"><IMG SRC="/library/images/gifs/toolbar/home.gif" WIDTH=103 HEIGHT=21 ALT="Microsoft Home" BORDER=0></A><A HREF="/products/default.asp" TARGET="_top"><IMG SRC="/library/images/gifs/toolbar/prod.gif" WIDTH=81 HEIGHT=21 ALT="Products" BORDER=0></A><A HREF="/search/default.asp" target="_top"><IMG SRC="/library/images/gifs/toolbar/search.gif" WIDTH=68 HEIGHT=21 ALT="Search" BORDER=0></A><A HREF="/support/" TARGET="_top"><IMG SRC="/library/images/gifs/toolbar/support_on.gif" WIDTH=74 HEIGHT=21 ALT="Support" BORDER=0></A><A HREF="/referral/default.asp" TARGET="_top"><IMG SRC="/library/images/gifs/toolbar/shop.gif" WIDTH=55 HEIGHT=21 ALT="Shop" BORDER=0></A><A HREF="/regwiz/regwiz.asp" TARGET="_top"><IMG SRC="/library/images/gifs/toolbar/write.gif" WIDTH=78 HEIGHT=21 ALT="Write Us" BORDER=0></A><IMG SRC="/library/images/gifs/toolbar/spacer.gif" WIDTH=49 HEIGHT=21 ALT="" BORDER=0>
		</FONT>
		</NOBR>
		</TD>

		<TD BGCOLOR="#000000" WIDTH=100% HEIGHT=20>
		</TD>

		<TD WIDTH=91 ROWSPAN=2 ALIGN=RIGHT VALIGN=TOP>
		<FONT FACE="Arial, Helvetica" SIZE=1>
		<A HREF="/" TARGET="_top"><IMG SRC="/library/images/gifs/toolbar/msft.gif" WIDTH=91 HEIGHT=21 ALT="Microsoft Home" BORDER=0></A>
		</FONT>
		</TD>
	</TR>
	<TR>
		<TD BGCOLOR="#FFFFFF" WIDTH=100% HEIGHT=1>
		</TD>
	</TR>
</TABLE>
<!--TOOLBAR_END-->

<!--PRODUCTBAR_START-->
<TABLE WIDTH=100% CELLPADDING=0 CELLSPACING=0 BORDER=0>
	<TR>
		<TD WIDTH=133>
		<A HREF="/support/mtshome.htm" TARGET="_top">
		<IMG SRC="/support/images/buttons/mtsico.gif" WIDTH=133 HEIGHT=75 BORDER=0 ALT="Return to Microsoft Technical Support Home Page">
		</A>
		</TD>

		<TD WIDTH=100%>
		<CENTER>
		<A HREF="/kb/" TARGET="_top">
		<IMG SRC="/support/images/banners/kb2ban.gif" WIDTH=330 HEIGHT=75 BORDER=0 ALT="Microsoft Knowledge Base">
		</A>
		</CENTER>
		</TD>
	</TR>
</TABLE>
<!--PRODUCTBAR_END-->
<!--BUTTONBAR_START-->
<TABLE WIDTH=145 CELLPADDING=0 CELLSPACING=0 BORDER=0 ALIGN=LEFT>
	<TR>
		<TD WIDTH=133>
		<IMG SRC="/support/images/buttons/topbar.gif" WIDTH=133 HEIGHT=4 BORDER=0 ALT=""><BR>
		<A HREF="/support/sitemap.htm">
		<IMG SRC="/support/images/buttons/siteup.gif" WIDTH=133 HEIGHT=18 BORDER=0 ALT="Site Map"><BR>
		</A>
		<A HREF="/support/default-wizmain.htm">
		<IMG SRC="/support/images/buttons/tourup.gif" WIDTH=133 HEIGHT=29 BORDER=0 ALT="Guided Tour with the Support Wizard"><BR>
		</A>
		<A HREF="/kb/">
		<IMG SRC="/support/images/buttons/kbdn.gif" WIDTH=133 HEIGHT=18 BORDER=0 ALT="Search the Knowledge Base"><BR>
		</A>
		<A HREF="/support/tshooters.htm">
		<IMG SRC="/support/images/buttons/tshootup.gif" WIDTH=133 HEIGHT=18 BORDER=0 ALT="Troubleshooting Wizards"><BR>
		</A>
		<A HREF="/support/default-faq.htm">
		<IMG SRC="/support/images/buttons/faqup.gif" WIDTH=133 HEIGHT=29 BORDER=0 ALT="Read our Frequently Asked Questions"><BR>
		</A>
		<A HREF="/kb/softlib/">
		<IMG SRC="/support/images/buttons/dloadup.gif" WIDTH=133 HEIGHT=29 BORDER=0 ALT="Download a Help File, Service Pack & Other Files"><BR>
		</A>
		<A HREF="/support/news/">
		<IMG SRC="/support/images/buttons/newsup.gif" WIDTH=133 HEIGHT=18 BORDER=0 ALT="Browse the Newsgroups"><BR>
		</A>
		<A HREF="/supportnet/">
		<IMG SRC="/support/images/buttons/suppup.gif" WIDTH=133 HEIGHT=29 BORDER=0 ALT="Support Options and Numbers"><BR>
		</A>
		<A HREF="/support/webresponse.htm">
		<IMG SRC="/support/images/buttons/webrup.gif" WIDTH=133 HEIGHT=29 BORDER=0 ALT="Submit a Question to a Support Engineer"><BR>
		</A>
		<IMG SRC="/support/images/buttons/botbar.gif" WIDTH=133 HEIGHT=4 BORDER=0 ALT=""><BR>
		
<!--IESPACE_START-->
			<BR>
			<center>
			<font face="Arial" size=-1 color="000000"><B>
			<span style="font-size:8pt; color:000000">
			Best experienced with<BR>
			<A HREF="/automap/"><IMG SRC="/library/images/gifs/general/ie_animated.gif" WIDTH=88 HEIGHT=31 ALT="Microsoft Internet Explorer" BORDER=0 ALIGN=center></A>
			<br>Click here to start.

			<BR><BR>
			</span></b></font>

			</center>
		<!--IESPACE_END-->
		</TD>

		<TD WIDTH=20>
		<!--20 Pixel Space-->
		</TD>
	</TR>
</TABLE>
<!--BUTTONBAR_END-->

<!--DOCBODY_START-->
<TABLE CELLPADDING=5 CELLSPACING=0 BORDER=0>
	<TR>
		<TD WIDTH=100%>
<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>
<UL>
<P>
<H2>How to Obtain &amp; Change the Paper Bins for the Default Printer</H2>
<B><I>Article ID: Q96797  <BR>
Creation Date: 28-MAR-1993<BR>
Revision Date: 21-JUN-1995
</I></B>
<P>

<FONT FACE="Arial, Helvetica" SIZE=2>

 
The information in this article applies to:
<P>
- Standard and Professional Editions of Microsoft Visual Basic for
</FONT>
<PRE>  Windows, versions 2.0 and 3.0
</PRE><FONT FACE="Arial, Helvetica" SIZE=2>
 
<P>
<P><FONT SIZE=3><B>SUMMARY</B></FONT> <BR>
 
<P>
By using the Windows API Escape() function, an application can change the
paper bin on the printer and obtain a list of available paper bins for the
default printer.
<P>
To return a list of paper bin names and a list of corresponding of bin
numbers, pass the ENUMPAPERBINS printer escape constant to the Escape()
function. You can use the first list to display the available paper bins
for the user, and use the second list to change the paper bin.
<P>
To change the paper bin, pass the GETSETPAPERBINS printer escape constant
along with the bin number to the Escape() function. GETSETPAPERBINS returns
the current bin and the number of bins supported by the default printer.
<P>
<P><FONT SIZE=3><B>MORE INFORMATION</B></FONT> <BR>
 
<P>
The example code listed below demonstrates how to use both ENUMPAPERBINS
and GETSETPAPERBINS with the Windows API Escape() function.
<P>
<P><FONT SIZE=3><B>An Important Note</B></FONT> <BR>
 
<P>
The Windows API Escape() function is provided in Windows versions 3.0 and
3.1 for backward compatibility with earlier versions of Microsoft Windows.
Applications are supposed to use the GDI DeviceCapabilities() and
ExtDeviceMode() functions instead of the Escape() function, but neither
DeviceCapabilities() nor ExtDeviceMode() can be called directly from Visual
Basic. This is because they are exported by the printer driver, not by the
Windows GDI. The only way to use ExtDeviceMode() or DeviceCapabilities()
in Visual Basic is to create a DLL and call them from there.
<P>
<P><FONT SIZE=3><B>Step-by-Step Example</B></FONT> <BR>
 

<OL>
<LI>Start Visual Basic or from the File menu, choose New Project (ALT, F, N)
   if Visual Basic is already running. Form1 is created by default.

<LI>From the File menu, choose New Module (ALT, F, M). Module1 is created
   by default.

<LI>Add the following code to the general declarations section of Module1:
<P>
   Global Const MaxBins = 6
   Type PaperBin         ' Used for EnumPaperBins
</FONT><BLOCKQUOTE>
<PRE>      BinList(1 To MaxBins) As Integer
      PaperNames(1 To MaxBins) As String * 24
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
   End Type
<P>
   Type BinInfo                ' Used for GetSetPaperBins
</FONT><BLOCKQUOTE>
<PRE>      CurBinNumber As Integer  ' Current Bin
      NumBins As Integer       ' Number of bins supported by printer
      Reserved1 As Integer     ' Reserved
      Reserved2 As Integer     ' Reserved
      Reserved3 As Integer     ' Reserved
      Reserved4 As Integer     ' Reserved
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
   End Type
   ' Enter each of the following Declare statements on one, single line.
   Declare Function EnumPaperBinEscape% Lib "GDI" Alias "Escape"
</FONT><BLOCKQUOTE>
<PRE>      (ByVal hDC%, ByVal nEscape%, ByVal nCount%, NumBins%,
      lpOutData As Any)
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
   Declare Function GetPaperBinEscape% Lib "GDI" Alias "Escape"
</FONT><BLOCKQUOTE>
<PRE>      (ByVal hDC%, ByVal nEscape%, ByVal nCount%, InBinInfo As Any,
      OutBinInfo As Any)
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
<P>
   Global Const ENUMPAPERBINS = 31
   Global Const GETSETPAPERBINS = 29

<LI>Add a command button (Command1) to Form1.

<LI>Add a list box (List1) to Form1.

<LI>Add the following code to the Command1_Click event procedure:
<P>
   Sub Command1_Click ()
</FONT><BLOCKQUOTE>
<PRE>      Dim InPaperBin As PaperBin
      Dim InBinInfo As BinInfo
      ' Enter each of the following result% statements on one, single line:
      result% = GetPaperBinEscape(Printer.hDC, GETSETPAPERBINS, 0,
         ByVal 0&amp;, InBinInfo)
      result% = EnumPaperBinEscape(Printer.hDC, ENUMPAPERBINS, 2,
         MaxBins, InPaperBin)
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
<P>
</FONT><BLOCKQUOTE>
<PRE>      List1.Clear
      For I% = 1 To InBinInfo.NumBins ' Fill list1 with available bins
         List1.AddItem InPaperBin.PaperNames(I%)
         List1.ItemData(List1.NewIndex) = InPaperBin.BinList(I%)
      Next I%
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
<P>
   End Sub

<LI>Add the following code to the List1_Click event procedure:
<P>
   Sub List1_Click ()
</FONT><BLOCKQUOTE>
<PRE>      Dim InBinInfo As BinInfo
      Dim NewBinInfo As BinInfo
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
<P>
</FONT><BLOCKQUOTE>
<PRE>      NewBinInfo.CurBinNumber = List1.ItemData(List1.ListIndex)
      ' Enter the following result% statement on one, single line.
      result% = GetPaperBinEscape(Printer.hDC, GETSETPAPERBINS,
         Len(NewBinInfo), NewBinInfo, NewBinInfo)
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
<P>
</FONT><BLOCKQUOTE>
<PRE>      MsgBox "Sending Sample Output to printer using Bin: " + List1.Text
      Printer.Print "This should of have come from Bin: "; List1.Text
      Printer.EndDoc
</PRE></BLOCKQUOTE><FONT FACE="Arial, Helvetica" SIZE=2>
   End Sub

<LI>From the Run menu, choose Start (ALT, R, S) to run the program.

<LI>Choose the Command1 button to see a list of available paper bins for the
   default printer listed in the List1 box.

<LI>Select one of the paper bins listed in the List1 box. A message box
</FONT><BLOCKQUOTE>
<PRE>    appears to tell you that a sample printout is being sent to the printer
    using the paper bin you selected.
<P></BLOCKQUOTE>
</OL>
</FONT>

</UL>
</FONT>
		</TD>
	</TR>
</TABLE>
<!--DOCBODY_END-->

<!--FOOTER_START-->
	<HR WIDTH=80%>

<BLOCKQUOTE>
THE INFORMATION PROVIDED IN THE MICROSOFT KNOWLEDGE BASE IS
PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND.  MICROSOFT DISCLAIMS
ALL WARRANTIES, EITHER EXPRESS OR IMPLIED, INCLUDING THE WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  IN NO
EVENT SHALL MICROSOFT CORPORATION OR ITS SUPPLIERS BE LIABLE FOR
ANY DAMAGES WHATSOEVER INCLUDING DIRECT, INDIRECT, INCIDENTAL,
CONSEQUENTIAL, LOSS OF BUSINESS PROFITS OR SPECIAL DAMAGES, EVEN IF
MICROSOFT CORPORATION OR ITS SUPPLIERS HAVE BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.  SOME STATES DO NOT ALLOW THE EXCLUSION
OR LIMITATION OF LIABILITY FOR CONSEQUENTIAL OR INCIDENTAL DAMAGES
SO THE FOREGOING LIMITATION MAY NOT APPLY.
</BLOCKQUOTE>

	<CENTER><I>
	<A STYLE="font-size:8pt; font-style:italic">&copy;1997 Microsoft Corporation. All rights reserved. </A> <A STYLE="font-size:8pt; font-style:italic" HREF="/MISC/CPYRIGHT.HTM" HREF="/misc/cpyright.htm">Legal Notices</A>.<BR>
	</I></CENTER>

<CENTER><BR>
Additional reference words: 2.00 3.00<BR>
KBCategory: kbprint kbprg kbcode<BR>
KBSubcategory: APrgPrint<BR>

</CENTER>

<!--FOOTER_END-->
</FONT>
</BODY>
</HTML>
