<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0045)http://support.microsoft.com/kb/184686/EN-US/ -->
<!-- CPMSFTWBSUP14 ASM: GsfxWeb, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 - FW: 1.1.4322.985 --><!-- RESG: 10/17/2004 10:13:47 AM - RESX: 1/1/0001 12:00:00 AM --><!-- (c) 2004 Microsoft Corporation. All Rights Reserved --><HTML><HEAD><TITLE>How To Disable the Close Option on Control Menu of a VB Form</TITLE><LINK 
href="How To Disable the Close Option on Control Menu of a VB Form_files/d3e6e07eS.css" 
type=text/css rel=Stylesheet><LINK 
href="How To Disable the Close Option on Control Menu of a VB Form_files/b433593aS.css" 
type=text/css rel=stylesheet>
<SCRIPT language=JavaScript>var doImage=doImage;var TType=TType;function mhHover(tbl,idx,cls){var t,d;if(document.getElementById)t=document.getElementById(tbl);else t=document.all(tbl);if(t==null)return;if(t.getElementsByTagName)d=t.getElementsByTagName("TD");else d=t.all.tags("TD");if(d==null)return;if(d.length<=idx)return;d[idx].className=cls;}function setMSResearch(){var time=new Date();if(document.cookie.indexOf('msresearch=1 ')==-1){document.cookie='msresearch='+time.getTime()+':'+escape(document.location)+':'+escape(document.referrer)+'; path=/; domain=.microsoft.com; ';}}function footerjs(doc){if(doImage==null){var tt=TType==null?"PV":TType;doc.write('<layer visibility="hide"><div style="display:none"><img src="http://c.microsoft.com/trans_pixel.asp?source=localhost&TYPE=' + tt + '&p=MNPGenerator" width=0 height=0 hspace=0 vspace=0 border=0></div></layer>');}if((document.cookie.indexOf('msresearch=1 ')==-1)&&(document.cookie.indexOf('msresearch=')!=-1)){setInterval("setMSResearch()",1000);}}</SCRIPT>

<SCRIPT 
src="How To Disable the Close Option on Control Menu of a VB Form_files/common.js" 
type=text/javascript></SCRIPT>

<META 
content="5584 5583 5579 5577 5576 5575 5573 5572 2971 2970 2969 1105 5570 " 
name=KBParents>
<META content="kbgrpdsvb kbhowto KB184686" name=Keywords>
<META 
content="To modify an item in the Visual Basic Control menu (also known as the System menu), you need to use the SetMenuItemInfo API function. This article describes how to enable/disable or check/uncheck the Close menu item in the Control menu. If you do..." 
name=Description>
<META content=en name=MS.LOCALE>
<META http-equiv=content-type 
content="text/html; charset=utf-8"><XMLREADER><LINK 
href="How To Disable the Close Option on Control Menu of a VB Form_files/default.css" 
type=text/css rel=stylesheet><LINK 
href="How To Disable the Close Option on Control Menu of a VB Form_files/xmlContent.css" 
type=text/css rel=stylesheet></XMLREADER>
<SCRIPT>var g_currentContent='kb\x3ben-us\x3b184686';</SCRIPT>

<SCRIPT 
src="How To Disable the Close Option on Control Menu of a VB Form_files/survey.js" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>var PersonalizationInfo='a2IxODQ2ODYIZW4tdXMISG93IFRvICBEaXNhYmxlIHRoZSBDbG9zZSA_';SaveToFavoritesData.savingMsg='Saving Favorites';SaveToFavoritesData.connectionErrorMsg='Cannot Connect';SaveToFavoritesData.savedMsg='Favorites Saved';SaveToFavoritesData.noSaveErrorMsg='Cannot Save';SaveToFavoritesData.surveyUrl='\x2fcommon\x2fsurvey.aspx\x3fscid\x3dsw\x3ben\x3b1076\x26surveystyle\x3dpopup\x26showpage\x3d1\x26site\x3dgn\x26siteregion\x3den-us\x26url\x3d%2fdefault.aspx%2fkb%2f184686%2fEN-US%2f\x26p0\x3dkb\x26p1\x3den-us\x26p2\x3d184686';SaveToFavoritesData.noCookieUrl='\x2fgp\x2fnocookies\x2f';var gCookieDomain='';</SCRIPT>

<META content="MSHTML 6.00.2900.2523" name=GENERATOR></HEAD>
<BODY onload=thisLoad(); onunload=thisUnload();>
<SCRIPT type=text/javascript>if (self.name == "MNPMainFrame") top.location.href = self.location.href;</SCRIPT>

<DIV id=msviMasthead 
xmlns:Utility="http://www.microsoft.com/MSCOM/VisualIdentity/Utility">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <TABLE height=22 cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD id=msviRegionIdGraphic bgColor=#4b92d9><A 
            href="http://support.microsoft.com/common/international.aspx"><IMG 
            title="Language Options" height=22 alt="United States" 
            src="How To Disable the Close Option on Control Menu of a VB Form_files/99b166acS.jpg" 
            border=0></A></TD>
          <TD id=msviRegionGradient1 
          style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#4B92D9', endColorStr='#CEDFF6', gradientType='1')" 
          width="50%"></TD>
          <TD id=msviRegionGradient2 
          style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#CEDFF6', endColorStr='#1E77D3', gradientType='1')" 
          width="50%"></TD></TR></TBODY></TABLE></TD>
    <TD id=msviGlobalToolbar dir=ltr noWrap align=left bgColor=#1e77d3 
height=22>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=gt0 onmouseover="mhHover('msviGlobalToolbar', 0, 'gt1')" 
          onmouseout="mhHover('msviGlobalToolbar', 0, 'gt0')" noWrap><A 
            href="http://www.microsoft.com/">Microsoft.com Home</A></TD>
          <TD class=gtsep>|</TD>
          <TD class=gt0 onmouseover="mhHover('msviGlobalToolbar', 2, 'gt1')" 
          onmouseout="mhHover('msviGlobalToolbar', 2, 'gt0')" noWrap><A 
            href="http://support.microsoft.com/library/toolbar/3.0/sitemap/en-us.mspx">Site 
            Map</A></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD width="100%">
      <TABLE height=42 cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=msviBrandBanner bgColor=#0a6cce><A 
            href="http://www.microsoft.com/"><IMG title="" height=42 
            alt=Microsoft 
            src="How To Disable the Close Option on Control Menu of a VB Form_files/ms_masthead_ltr.gif" 
            width=136 border=0></A></TD>
          <TD 
          style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#0A6CCE', endColorStr='#FFFFFF', gradientType='1')" 
          width="100%"></TD></TR></TBODY></TABLE></TD>
    <TD id=msviGlobalSearch bgColor=#ffffff>Search Microsoft.com for:<BR>
      <FORM id=msviSearchForm action=/library/toolbar/3.0/search.aspx><INPUT 
      type=hidden value=en-us name=View><INPUT type=hidden value=iso-8859-1 
      name=charset><NOBR>
      <DIV style="HEIGHT: 18px"><INPUT id=msviSearchBox maxLength=255 name=qu><INPUT id=msviGoButton type=submit value=Go></DIV></NOBR></FORM></TD></TR></TBODY></TABLE>
<TABLE id=msviSubbanner cellSpacing=0 cellPadding=0 width="100%" bgColor=#003399 
border=0>
  <TBODY>
  <TR>
    <TD><IMG title="" height=26 alt="Help and Support" 
      src="How To Disable the Close Option on Control Menu of a VB Form_files/4101ccf1S.jpg" 
      width=467 border=0></TD>
    <TD width="100%">&nbsp;</TD></TR></TBODY></TABLE>
<DIV id=msviLocalToolbar>
<TABLE height=19 cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD id=msviHomePageLink noWrap><A 
      href="http://support.microsoft.com/">Help and Support Home</A></TD>
    <TD><SPAN class=ltsep>|</SPAN></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 2, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 2, 'lt0')" noWrap><A 
      href="http://support.microsoft.com/select/?target=hub">Select a 
    Product</A></TD>
    <TD><SPAN class=ltsep>|</SPAN></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 4, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 4, 'lt0')" noWrap><A 
      href="http://support.microsoft.com/search/?adv=1">Search</A></TD>
    <TD width="100%"></TD></TR></TBODY></TABLE></DIV></DIV>
<TABLE dir=ltr cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD dir=ltr width="100%"><XMLREADER>
      <DIV id=contentArea>
      <DIV id=mainRow>
      <DIV id=thinColumn>
      <DIV class="wp articleTrans">
      <H1>Article Translations</H1>
      <FORM name=frmArticleTrans onsubmit="return SwitchLanguage();" action=/>
      <DIV>
      <TABLE cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><SELECT name=scid><OPTION value=kb;fr;184686 
              selected>French</OPTION><OPTION 
              value=kb;de;184686>German</OPTION><OPTION 
              value=kb;ja;184686>Japanese</OPTION><OPTION 
              value=kb;es;184686>Spanish</OPTION></SELECT></TD>
          <TD class=spacer>&nbsp;</TD>
          <TD><INPUT 
            onmouseover="this.src='/library/images/support/EN-US/go_right_02-over.gif';" 
            onmouseout="this.src='/library/images/support/EN-US/go_right_02.gif';" 
            type=image alt="Translate the article" 
            src="How To Disable the Close Option on Control Menu of a VB Form_files/go_right_02.gif"></TD></TR></TBODY></TABLE></DIV></FORM></DIV>
      <DIV class=wp id=RelatedSupportCenters>
      <TABLE cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD class=textColumn>
            <H1>Related Support Centers</H1>
            <TABLE class=list cellSpacing=0 cellPadding=2>
              <TBODY>
              <TR class=evenRow>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=bullet>•</TD>
                      <TD class=text><A 
                        href="http://support.microsoft.com/?scid=ph;en-us;2971">Microsoft 
                        Visual Basic 
            6.0</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <DIV class=wp id=AdditionalResources>
      <TABLE cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD class=textColumn>
            <H1>Other Support Options</H1>
            <TABLE class=list cellSpacing=0 cellPadding=2>
              <TBODY>
              <TR class=evenRow id=L_259_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=bullet>•</TD>
                      <TD class=text><A id=L_259 title="Contact Microsoft" 
                        onclick="return MS_HandleClick(this,'AdditionalResources', true);" 
                        href="http://support.microsoft.com/?scid=gp;[ln];cntactms&amp;style=home">Contact 
                        Microsoft</A><BR>Phone Numbers, Support Options and 
                        Pricing, Online Help, and 
more.</TD></TR></TBODY></TABLE></TD></TR>
              <TR class=oddRow id=L_260_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=bullet>•</TD>
                      <TD class=text><A id=L_260 title="Customer Service" 
                        onclick="return MS_HandleClick(this,'AdditionalResources', true);" 
                        href="http://support.microsoft.com/?scid=gp;[ln];csshome&amp;style=home">Customer 
                        Service</A><BR>For non-technical assistance with product 
                        purchases, subscriptions, online services, events, 
                        training courses, corporate sales, piracy issues, and 
                        more.</TD></TR></TBODY></TABLE></TD></TR>
              <TR class=evenRow id=L_262_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=bullet>•</TD>
                      <TD class=text><A id=L_262 title=Newsgroups 
                        onclick="return MS_HandleClick(this,'AdditionalResources', true);" 
                        href="http://support.microsoft.com/newsgroups/">Newsgroups</A><BR>Pose 
                        a question to other users. Discussion groups and Forums 
                        about specific Microsoft products, technologies, and 
                        services.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <DIV class=wp id=SupportTools>
      <TABLE cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD class=textColumn>
            <H1>Page Tools</H1>
            <TABLE class=list cellSpacing=0 cellPadding=2>
              <TBODY>
              <TR class=evenRow id=PrintPage_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=image><A id=PrintPage_i 
                        title="Print this page" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/gp/noscript/"><IMG 
                        id=bi_PrintPage alt="Print this page" 
                        src="How To Disable the Close Option on Control Menu of a VB Form_files/printicon.gif"></A></TD>
                      <TD class=text><A id=PrintPage title="Print this page" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/gp/noscript/">Print 
                        this page</A></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=oddRow id=EmailPage_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=image><A id=EmailPage_i 
                        title="E-mail this page" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="mailto:?subject=How To  Disable the Close Option on Control Menu of a VB Form&amp;body=http://support.microsoft.com/default.aspx/kb/184686/EN-US/"><IMG 
                        id=bi_EmailPage alt="E-mail this page" 
                        src="How To Disable the Close Option on Control Menu of a VB Form_files/emailicon.gif"></A></TD>
                      <TD class=text><A id=EmailPage title="E-mail this page" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="mailto:?subject=How To  Disable the Close Option on Control Menu of a VB Form&amp;body=http://support.microsoft.com/default.aspx/kb/184686/EN-US/">E-mail 
                        this page</A></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=evenRow id=Worldwide_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=image><A id=Worldwide_i 
                        title="Microsoft Worldwide" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/common/international.aspx?rdPath=0"><IMG 
                        id=bi_Worldwide alt="Microsoft Worldwide" 
                        src="How To Disable the Close Option on Control Menu of a VB Form_files/langicon.gif"></A></TD>
                      <TD class=text><A id=Worldwide 
                        title="Microsoft Worldwide" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/common/international.aspx?rdPath=0">Microsoft 
                        Worldwide</A></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=oddRow id=SaveToMySupportFavorites_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=image><A id=SaveToMySupportFavorites_i 
                        title="Save to My Support Favorites" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/gp/noscript/"><IMG 
                        id=bi_SaveToMySupportFavorites 
                        alt="Save to My Support Favorites" 
                        src="How To Disable the Close Option on Control Menu of a VB Form_files/saveicon.gif"></A></TD>
                      <TD class=text><A id=SaveToMySupportFavorites 
                        title="Save to My Support Favorites" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/gp/noscript/">Save to 
                        My Support Favorites</A></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=evenRow id=MySupportFavoritesLink_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=image><A id=MySupportFavoritesLink_i 
                        title="Go to My Support Favorites" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/personalization/mydisplaysettings.aspx"><IMG 
                        id=bi_MySupportFavoritesLink 
                        alt="Go to My Support Favorites" 
                        src="How To Disable the Close Option on Control Menu of a VB Form_files/gotoicon.gif"></A></TD>
                      <TD class=text><A id=MySupportFavoritesLink 
                        title="Go to My Support Favorites" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/personalization/mydisplaysettings.aspx">Go 
                        to My Support Favorites</A></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=oddRow id=SendFeedback_tr>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=image><A id=SendFeedback_i 
                        title="Send Feedback" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/gp/noscript/" 
                        target=_blank><IMG id=bi_SendFeedback 
                        alt="Send Feedback" 
                        src="How To Disable the Close Option on Control Menu of a VB Form_files/sendicon.gif"></A></TD>
                      <TD class=text><A id=SendFeedback title="Send Feedback" 
                        onclick="return MS_HandleClick(this,'SupportTools', false);" 
                        href="http://support.microsoft.com/gp/noscript/" 
                        target=_blank>Send 
Feedback</A></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=evenRow>
                <TD class=lc0>
                  <TABLE class=innerTable cellSpacing=0 cellPadding=0>
                    <TBODY>
                    <TR>
                      <TD class=text>
                        <DIV class=center><A 
                        href="https://profile.microsoft.com/RegSysProfileCenter/wizard.aspx?wizid=6182013c-7c1f-40a3-99ae-27651c3668aa&amp;lcid=1033&amp;fu=%2fdefault.aspx%2fkb%2f184686%2fEN-US%2f&amp;brand=Microsoft"><IMG 
                        class=PassportSignIn 
                        alt="Sign in with your .NET Passport" 
                        src="How To Disable the Close Option on Control Menu of a VB Form_files/signin.gif" 
                        border=0></A></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV></DIV>
      <DIV id=mainColumn>
      <DIV class=kb id=kb>
      <DIV class=default id=default><!-- - -KB 3 start- - --><A name=toc></A>
      <H1 class=title>How To Disable the Close Option on Control Menu of a VB 
      Form</H1>
      <DIV class=articleProperty>
      <TABLE>
        <TBODY>
        <TR>
          <TD class=label>Article ID</TD>
          <TD class=text>:</TD>
          <TD class=text>184686</TD></TR>
        <TR>
          <TD class=label>Last Review</TD>
          <TD class=text>:</TD>
          <TD class=text>July 1, 2004</TD></TR>
        <TR>
          <TD class=label>Revision</TD>
          <TD class=text>:</TD>
          <TD class=text>3.1</TD></TR></TBODY></TABLE></DIV>
      <DIV class=notice>This article was previously published under 
Q184686</DIV>
      <DIV class=toc>
      <H5>On this Page</H5>
      <TABLE class=tallTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD class=image><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#kb1"><IMG 
            alt=SUMMARY 
            src="How To Disable the Close Option on Control Menu of a VB Form_files/downArrow.gif" 
            align=middle></A></TD>
          <TD class=text colSpan=2><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#kb1">SUMMARY</A></TD></TR>
        <TR>
          <TD class=image><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#kb2"><IMG 
            alt="MORE INFORMATION" 
            src="How To Disable the Close Option on Control Menu of a VB Form_files/downArrow.gif" 
            align=middle></A></TD>
          <TD class=text colSpan=2><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#kb2">MORE 
            INFORMATION</A></TD></TR>
        <TR>
          <TD class=image><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#kb3"><IMG 
            alt=REFERENCES 
            src="How To Disable the Close Option on Control Menu of a VB Form_files/downArrow.gif" 
            align=middle></A></TD>
          <TD class=text colSpan=2><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#kb3">REFERENCES</A></TD></TR></TBODY></TABLE></DIV>
      <DIV class=section>
      <H2 class=subTitle><A name=kb1>SUMMARY</A></H2>
      <DIV class=sbody>To modify an item in the Visual Basic Control menu (also 
      known as the System menu), you need to use the SetMenuItemInfo API 
      function. This article describes how to enable/disable or check/uncheck 
      the Close menu item in the Control menu. </DIV>
      <H2 class=subTitle><A name=kb2>MORE INFORMATION</A></H2>
      <DIV class=sbody>If you do not want the user to close a window via the 
      Control menu or the Close box on your Form's title bar, you can disable 
      the Close menu item on the Control menu. This method also disables 
      double-clicking the Control box and disables the Close button on the 
      Form's title bar. <BR><BR>The following code sample enables/disables and 
      checks/unchecks the Close command in the Visual Basic Control menu. <BR>
      <H3>Example</H3>
      <TABLE class=list>
        <TBODY>
        <TR>
          <TD class=number>1.</TD>
          <TD class=text>Start a new standard EXE project. Form1 is added by 
            default. </TD></TR>
        <TR>
          <TD class=number>2.</TD>
          <TD class=text>Add three CommandButtons to Form1. </TD></TR>
        <TR>
          <TD class=number>3.</TD>
          <TD class=text>Add the following code to Form1: <CODE><PRE class=code>      Option Explicit

      'Menu item constants.
      Private Const SC_CLOSE       As Long = &amp;HF060&amp;

      'SetMenuItemInfo fMask constants.
      Private Const MIIM_STATE     As Long = &amp;H1&amp;
      Private Const MIIM_ID        As Long = &amp;H2&amp;

      'SetMenuItemInfo fState constants.
      Private Const MFS_GRAYED     As Long = &amp;H3&amp;
      Private Const MFS_CHECKED    As Long = &amp;H8&amp;

      'SendMessage constants.
      Private Const WM_NCACTIVATE  As Long = &amp;H86

      'User-defined Types.
      Private Type MENUITEMINFO
          cbSize        As Long
          fMask         As Long
          fType         As Long
          fState        As Long
          wID           As Long
          hSubMenu      As Long
          hbmpChecked   As Long
          hbmpUnchecked As Long
          dwItemData    As Long
          dwTypeData    As String
          cch           As Long
      End Type

      'Declarations.
      Private Declare Function GetSystemMenu Lib "user32" ( _
          ByVal hwnd As Long, ByVal bRevert As Long) As Long

      Private Declare Function GetMenuItemInfo Lib "user32" Alias _
          "GetMenuItemInfoA" (ByVal hMenu As Long, ByVal un As Long, _
          ByVal b As Boolean, lpMenuItemInfo As MENUITEMINFO) As Long

      Private Declare Function SetMenuItemInfo Lib "user32" Alias _
          "SetMenuItemInfoA" (ByVal hMenu As Long, ByVal un As Long, _
          ByVal bool As Boolean, lpcMenuItemInfo As MENUITEMINFO) As Long

      Private Declare Function SendMessage Lib "user32" Alias _
          "SendMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, _
          ByVal wParam As Long, lParam As Any) As Long

      'Application-specific constants and variables.
      Private Const xSC_CLOSE  As Long = -10
      Private Const SwapID     As Long = 1
      Private Const ResetID    As Long = 2

      Private hMenu  As Long
      Private MII    As MENUITEMINFO

      Private Sub Command1_Click()
          Dim Ret As Long

          Ret = SetId(SwapID)
          If Ret &lt;&gt; 0 Then

              If MII.fState = (MII.fState Or MFS_GRAYED) Then
                  MII.fState = MII.fState - MFS_GRAYED
              Else
                  MII.fState = (MII.fState Or MFS_GRAYED)
              End If

              MII.fMask = MIIM_STATE
              Ret = SetMenuItemInfo(hMenu, MII.wID, False, MII)
              If Ret = 0 Then
                  Ret = SetId(ResetID)
              End If

              Ret = SendMessage(Me.hwnd, WM_NCACTIVATE, True, 0)
              SetButtons
          End If
      End Sub

      Private Sub Command2_Click()
          Dim Ret As Long

          If MII.fState = (MII.fState Or MFS_CHECKED) Then
              MII.fState = MII.fState - MFS_CHECKED
          Else
              MII.fState = (MII.fState Or MFS_CHECKED)
          End If

          MII.fMask = MIIM_STATE
          Ret = SetMenuItemInfo(hMenu, MII.wID, False, MII)
          SetButtons
      End Sub

      Private Sub Command3_Click()
          Unload Me
      End Sub

      Private Function SetId(Action As Long) As Long
          Dim MenuID As Long
          Dim Ret As Long

          MenuID = MII.wID
          If MII.fState = (MII.fState Or MFS_GRAYED) Then
              If Action = SwapID Then
                  MII.wID = SC_CLOSE
              Else
                  MII.wID = xSC_CLOSE
              End If
          Else
              If Action = SwapID Then
                  MII.wID = xSC_CLOSE
              Else
                  MII.wID = SC_CLOSE
              End If
          End If

          MII.fMask = MIIM_ID
          Ret = SetMenuItemInfo(hMenu, MenuID, False, MII)
          If Ret = 0 Then
              MII.wID = MenuID
          End If
          SetId = Ret
      End Function

      Private Sub SetButtons()
          If MII.fState = (MII.fState Or MFS_GRAYED) Then
              Command1.Caption = "Enable"
          Else
              Command1.Caption = "Disable"
          End If
          If MII.fState = (MII.fState Or MFS_CHECKED) Then
              Command2.Caption = "Uncheck"
          Else
              Command2.Caption = "Check"
          End If
      End Sub

      Private Sub Form_Load()
          Dim Ret As Long

          hMenu = GetSystemMenu(Me.hwnd, 0)
          MII.cbSize = Len(MII)
          MII.dwTypeData = String(80, 0)
          MII.cch = Len(MII.dwTypeData)
          MII.fMask = MIIM_STATE
          MII.wID = SC_CLOSE
          Ret = GetMenuItemInfo(hMenu, MII.wID, False, MII)
          SetButtons
          Command3.Caption = "Exit"
      End Sub

						</PRE></CODE></TD></TR>
        <TR>
          <TD class=number>4.</TD>
          <TD class=text>Press the F5 key to run the program. 
      </TD></TR></TBODY></TABLE>
      <H3>Additional Notes</H3>Visual Basic handles enabling and disabling the 
      standard Control menu items, including Restore, Size, Move, Minimize, and 
      Maximize (the Close menu is always enabled). Generally, Visual Basic 
      enables/disables the menu items depending on the window's state 
      (minimized, maximized, or normal) by referencing these menu items by their 
      menu item IDs. <BR><BR>As a result, if we merely add or remove MFS_GRAYED 
      from a menu's fState, Visual Basic immediately resets it. The workaround 
      is to change the menu item's ID (which also renders the item inoperable). 
      <BR><BR>Using this workaround, we can effectively disable a menu item that 
      Visual Basic intends to be enabled, but we cannot enable a menu item 
      Visual Basic intends to be disabled (the menu item must have its regular 
      ID to be operable). <BR><BR>Enabling a menu item that Visual Basic intends 
      to be disabled requires removing the item and replacing it with a menu 
      item of our own (this is not covered in this article). <BR><BR>When the 
      Close menu item is enabled or disabled, the Close box on the title bar 
      should also be normal or grayed, respectively. Sending the message 
      WM_NCACTIVATE (nonclient activate) notifies the window to refresh its 
      title bar so the Close box is updated to appear normal or grayed. <BR>
      <H3>Additional Constants</H3><CODE><PRE class=code>   'Menu item constants
       Const SC_SIZE         As Long = &amp;HF000&amp;
       Const SC_SEPARATOR    As Long = &amp;HF00F&amp;
       Const SC_MOVE         As Long = &amp;HF010&amp;
       Const SC_MINIMIZE     As Long = &amp;HF020&amp;
       Const SC_MAXIMIZE     As Long = &amp;HF030&amp;
       Const SC_CLOSE        As Long = &amp;HF060&amp;
       Const SC_RESTORE      As Long = &amp;HF120&amp;

   'SetMenuItemInfo fMask Constants
       Const MIIM_STATE      As Long = &amp;H1&amp;
       Const MIIM_ID         As Long = &amp;H2&amp;
       Const MIIM_SUBMENU    As Long = &amp;H4&amp;
       Const MIIM_CHECKMARKS As Long = &amp;H8&amp;
       Const MIIM_TYPE       As Long = &amp;H10&amp;
       Const MIIM_DATA       As Long = &amp;H20&amp;
				</PRE></CODE><BR><BR>
      <H3>Related APIs</H3>
      <DIV class=indent>SetMenuDefaultItem -- You must disable Close to use this 
      in Visual Basic<BR>HiliteMenuItem </DIV></DIV>
      <H2 class=subTitle><A name=kb3>REFERENCES</A></H2>
      <DIV class=sbody>For the 16-bit equivalent, please see the following 
      article in the Microsoft Knowledge Base: <BR>
      <DIV class=indent><B><A class=KBlink 
      href="http://support.microsoft.com/kb/82876/EN-US/">82876</A></B> : How to 
      Disable Close Command in VB Control Menu (System Menu) </DIV></DIV></DIV>
      <DIV class=appliesTo>
      <HR>

      <H5>APPLIES TO</H5>
      <TABLE class=list cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 5.0 Learning Edition</TD></TR>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 6.0 Learning Edition</TD></TR>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 5.0 Professional Edition</TD></TR>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 6.0 Professional Edition</TD></TR>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 5.0 Enterprise Edition</TD></TR>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 6.0 Enterprise Edition</TD></TR>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 4.0 Standard Edition</TD></TR>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 4.0 Professional Edition</TD></TR>
        <TR>
          <TD class=bullet>•</TD>
          <TD class=text>Microsoft Visual Basic 4.0 32-Bit Enterprise 
          Edition</TD></TR></TBODY></TABLE></DIV>
      <DIV class=topOfPage>
      <TABLE>
        <TBODY>
        <TR>
          <TD class=image><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#toc"><IMG 
            alt="Top of Page" 
            src="How To Disable the Close Option on Control Menu of a VB Form_files/upArrow.gif" 
            align=middle></A></TD>
          <TD class=text><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#toc">Top of 
            Page</A></TD></TR></TBODY></TABLE></DIV>
      <DIV class=keywords>
      <TABLE cellSpacing=1 cellPadding=0>
        <TBODY>
        <TR>
          <TD class=header>
            <H5>Keywords:&nbsp;</H5></TD>
          <TD class=text>kbgrpdsvb kbhowto KB184686 </TD></TR></TBODY></TABLE>
      <DIV class=topOfPage>
      <TABLE>
        <TBODY>
        <TR>
          <TD class=image><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#toc"><IMG 
            alt="Top of Page" 
            src="How To Disable the Close Option on Control Menu of a VB Form_files/upArrow.gif" 
            align=middle></A></TD>
          <TD class=text><A 
            href="http://support.microsoft.com/kb/184686/EN-US/#toc">Top of 
            Page</A></TD></TR></TBODY></TABLE></DIV></DIV>
      <DIV class=disclaimer>
      <DIV 
class=text></DIV></DIV><!-- - -KB 3 end- - --></DIV></DIV></DIV></DIV>
      <DIV id=bottomRow>
      <DIV class=wp id=fmsSurvey>
      <DIV class=fms>
      <SCRIPT type=text/javascript>var g_asAnswers = [];var g_iAnswerPtr = 0;var currentsectionid = 1;var navindex = 1;var currentsection;var navpath = new Array();var g_SCID = 'sw;en;1075';var g_SITE = 'gn';var g_REGIONID = 'en-us';var g_URL = '%252fdefault.aspx%252fkb%252f184686%252fEN-US%252f';var g_BROWSERLANGCODE = 'en-us,fr\x3bq\x3d0.5';var g_SURVEYLANGCODE = 'en';var g_SURVEYID = '1075';var g_SURVEYNAME = '';var g_asParams = ['kb','en-us','184686','','','','','','',''];var g_showall = 0;var g_surveystyle = 'popup';var bClickCancel = 0;var g_maxKBsInCookie = '10';var g_kbvisited = '';</SCRIPT>
      <IFRAME id=submitframe style="DISPLAY: none" 
      src="How To Disable the Close Option on Control Menu of a VB Form_files/surveysubmit.html"></IFRAME>
      <DIV class=DOCUMENT>
      <FORM name=frmSurveyMain action=/common/survey.aspx method=post 
      width="100%"><INPUT id=FMSACTION type=hidden value=PERSIST 
      name=FMSACTION><INPUT id=emailaddress type=hidden name=emailaddress><INPUT 
      id=emailsurveyurl type=hidden name=emailsurveyurl><INPUT id=sessionid 
      type=hidden name=sessionid><INPUT id=SURVEYSCID type=hidden 
      name=SURVEYSCID><INPUT id=SURVEYID type=hidden name=SURVEYID><INPUT 
      id=REGIONID type=hidden name=REGIONID><INPUT id=SURVEYNAME type=hidden 
      name=SURVEYNAME><INPUT id=SURVEYLANGCODE type=hidden 
      name=SURVEYLANGCODE><INPUT id=BROWSERLANGCODE type=hidden 
      name=BROWSERLANGCODE><INPUT id=SITE type=hidden name=SITE><INPUT id=FMSURL 
      type=hidden name=FMSURL><INPUT id=PARAMS type=hidden name=PARAMS><INPUT 
      id=PARAMLENGTH type=hidden name=PARAMLENGTH><INPUT id=SURVEYANSWERS 
      type=hidden name=SURVEYANSWERS><INPUT id=DATALENGTH type=hidden 
      name=DATALENGTH><INPUT id=DIRECTION type=hidden value=LTR 
      name=DIRECTION><INPUT id=PREVIEWLOCATION type=hidden name=PREVIEWLOCATION>
      <DIV id=DIV_FIRST style="DISPLAY: none">
      <DIV class=QUESTIONCONTAINER>
      <DIV class=QUESTIONTEXT>Did this content help you?</DIV>
      <DIV class=QUESTIONINSTRUCTION></DIV>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=125 type=radio value=0 
            name=s1q5811>Yes</TD></TR>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=126 type=radio value=0 
            name=s1q5811>No</TD></TR>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=1852 type=radio value=1 
            name=s1q5811>Maybe</TD></TR></TBODY></TABLE></DIV>
      <DIV class=QUESTIONCONTAINER>
      <DIV class=QUESTIONTEXT>Please select one option based on your first 
      choice:</DIV>
      <DIV class=QUESTIONINSTRUCTION></DIV>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=10057 type=radio value=1 
            name=s1q5812>I'm very satisfied</TD></TR>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=10058 type=radio value=2 
            name=s1q5812>I think it will help, but I haven't tried it yet</TD></TR>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=10059 type=radio value=3 
            name=s1q5812>It is helpful, but I need more information</TD></TR>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=10060 type=radio value=4 
            name=s1q5812>It is helpful, but hard to understand</TD></TR>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=10061 type=radio value=5 
            name=s1q5812>Seemed relevant in search results, but didn't help 
        me</TD></TR>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=10062 type=radio value=6 
            name=s1q5812>The information is wrong</TD></TR>
        <TR>
          <TD class=ANSWERTEXT vAlign=top><INPUT id=10063 type=radio value=7 
            name=s1q5812>The page contains one or more broken 
      links</TD></TR></TBODY></TABLE></DIV>
      <TABLE class=QUESTIONCONTAINER cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD>
            <DIV class=QUESTIONTEXT>Suggest new content or let us know how we 
            can improve this content (optional):</DIV></TD></TR>
        <TR>
          <TD>
            <DIV class=QUESTIONINSTRUCTION></DIV></TD></TR>
        <TR>
          <TD><TEXTAREA class=ANSWERBOX onpaste="enforceMaxLength(this, 999)" onkeydown="enforceMaxLength(this, 999)" name=s1q3888 rows=12 cols=80></TEXTAREA></TD></TR></TBODY></TABLE>
      <DIV class=NAVIGATION>
      <TABLE width="98%">
        <TBODY>
        <TR>
          <TD noWrap align=right><INPUT class=NAVBUTTON onclick="closesurvey(10);SwitchSection();StatsDotNet.disabled = true;" type=button value=Submit></TD></TR></TBODY></TABLE></DIV></DIV>
      <SCRIPT type=text/javascript>var firstSection = document.getElementById("DIV_FIRST");</SCRIPT>

      <DIV id=DIV_CLOSE style="DISPLAY: none">
      <DIV class=SURVEYINTROTEXT>Thank you for your comments.</DIV>
      <SCRIPT type=text/javascript>var lastSection = document.getElementById("DIV_CLOSE");</SCRIPT>
      </DIV></FORM></DIV></DIV></DIV></DIV>
      <DIV id=widthFix></DIV></DIV></XMLREADER></TD></TR></TBODY></TABLE><BR 
style="OVERFLOW: hidden; LINE-HEIGHT: 1px" clear=all>
<TABLE id=msviFooter cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR vAlign=bottom>
    <TD id=msviFooter2 
    style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#3F8CDA', gradientType='1')">
      <DIV id=msviLocalFooter><NOBR><A 
      href="http://go.microsoft.com/?linkid=317027">Manage Your Profile</A> 
      |</NOBR><WBR><NOBR><A href="http://support.microsoft.com/gp/cntactms" 
      target=_parent>Contact Us</A></NOBR></DIV>
      <DIV id=msviGlobalFooter><SPAN dir=ltr>©2004 Microsoft Corporation. All 
      rights reserved.&nbsp;</SPAN><NOBR><A 
      href="http://support.microsoft.com/tou/">Terms of Use</A> 
      |</NOBR><WBR><NOBR><A 
      href="http://support.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">Trademarks</A> 
      |</NOBR><WBR><NOBR><A href="http://support.microsoft.com/privacy/">Privacy 
      Statement</A></NOBR></DIV></TD></TR></TBODY></TABLE>
<SCRIPT language=javascript>var msviFooter2;if (document.getElementById){msviFooter2 = document.getElementById("msviFooter2");msviFooter2.style.filter = "";}</SCRIPT>

<TABLE height=58 cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR vAlign=top>
    <TD>
      <DIV style="WIDTH: 200px"></DIV></TD>
    <TD 
    style="FILTER: progid:DXImageTransform.Microsoft.Gradient(startColorStr='#FFFFFF', endColorStr='#3F8CDA', gradientType='1')" 
    width="100%"></TD></TR></TBODY></TABLE><IMG id=webmetriximg 
src="How To Disable the Close Option on Control Menu of a VB Form_files/onepix.gif">
<SCRIPT type=text/javascript>function thisLoad(){KBFeedBackShowSurvey();MS_WebMetrix('http\x3a\x2f\x2fc.microsoft.com\x2ftrans_pixel.asp\x3fTYPE\x3dSSPV\x26SOURCE\x3dSUPPORT\x26GUID\x3d1F4FC18C-F71E-47fb-8FC9-612F8EE59C61\x26URI\x3d\x252fgn\x252fen-us\x252fkb_en-us_184686\x26R\x3dhttp\x253a\x252f\x252fsupport.microsoft.com');g_reSupportedHostnames = new RegExp(".microsoft.com$|.passport.com$", "i");ForeignLink_Hookup(true);MNPResizeFix();}function thisUnload(){}</SCRIPT>
</BODY></HTML>
